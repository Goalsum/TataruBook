---
title: 表和视图
---
本页介绍db数据库文件中包含的所有表和视图。

**表**是用户需要提供的输入，是所有数据的源头。为了确保数据的完整性和一致性，在添加、修改表中的数据时，工具会进行各方面的校验，保证各表的数据不出现冲突和逻辑矛盾。

**视图**是工具计算出的报表，是用户关心的各项统计数据结果。每当任一张表的内容有任何更新，所有视图均会立即自动更新并反映最新的内容，视图的计算不需要手工触发。

有一些视图是面向用户提供报表数据的（比如资产统计），也有一些视图是另一些视图的中间计算结果，用户通常不需要关注（除非对最终的统计结果有疑问想要检查计算过程）。在下面的视图描述中，对于用户通常不需关注的视图会专门说明。

所有名字以check开头的视图都是用于检查数据一致性的。当数据一致时，这些check开头的视图应当不包含任何内容。如果发现某个check开头的视图内容不为空，TataruBook会在命令行报告相关的数据错误并提示用户修正。

# 表

## asset_info

资产列表，此处**资产**特指**具有独立价格**的标的。某一种货币、某一只股票、某一只有净值或价格的基金都可称为一个资产。你也可以把其他任何具有单位价格的物品定义为资产，比如房产、数字货币等等。

如果你只使用一种货币，且不持有或交易具有独立价格的投资品（货币基金的净值始终为1，因此不具有独立价格），那么你的`asset_info`表就只有一条记录：自己使用的货币。

**字段**
- `asset_index`（整数）：自动生成的索引，无需用户输入。
- `asset_name`（字符串）：资产名字，不允许为空。仅用于在视图中展示，不会影响计算。
- `asset_category`（整数）：资产类型，不允许为空。仅用于在视图中展示资产时排序使用（值小的资产排在前面），不会影响计算。如果对排序没有要求，可以把所有资产的`asset_category`都设置为`0`。

## standard_asset

标准资产，或者叫**本位币**。所有其他资产都会换算成本位币来统计价值。通常这张表中只应当有一条记录。

**字段**  
- `asset_index`（整数）：资产索引，不允许为空，必须是[asset_info表]({{ site.baseurl }}/table_view.html#asset_info)中存在的某个资产索引。

**约束**
- prices表中任一条记录的`asset_index`不允许等于该表中的`asset_index`，因为本位币自身的价格固定为`1`。

## account_info

账户列表。**账户**是**具有独立余额和交易记录**的实体。注意一张个人银行卡通常包含多个账户，比如活期账户、投资账户、信用账户等等，在给账户命名的时候应当注意。

账户余额并不一定是正数，因为负债也可以用账户记录。比如，大多数时候信用卡的余额就是负值，表示用户在这个账户上存在未来需要归还的负债。

有一类特殊的账户：**外部账户**，它的余额并不是用户的资产/负债的一部分，而是用户在某一方面的花费/收入的总额。这是因为，**复式记账法**要求任一笔交易必须发生在两个账户之间，因此对于日常开销或者工资收入这类交易，需要一个虚拟的外部账户作为交易的另一方。利用外部账户可以对用户各种开销/收入进行分类统计。

**字段**  
- `account_index`（整数）：自动生成的索引，无需用户输入。
- `account_name`（字符串）：账户名字，不允许为空。仅用于在视图中展示，不会影响计算。
- `asset_index`（整数）：账户对应的资产索引，即这个账户上放的是哪种资产。不允许为空，必须是[asset_info表]({{ site.baseurl }}/table_view.html#asset_info)中存在的某个资产索引。
- `is_external`（`0`或`1`）：为`0`表示是普通账户，为`1`表示是外部账户。
